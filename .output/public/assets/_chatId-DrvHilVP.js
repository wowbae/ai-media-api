import{c as z,r as o,e as fe,j as e,f as Le,g as Ve,h as Fe,i as Ue,R as _e,k as Oe,l as Re,m as $e,n as ze}from"./main-8bRSL_yA.js";import{c as ae,B as b,T as W,f as Je,D as we,a as xe,b as ve,X as ce,I as ge,d as ee,V as X,e as de,L as $,g as Ge,h as Ce,i as Be,j as He,k as pe,P as Y,M as qe,l as he,m as re,n as me,o as Ne,u as Ke,C as oe,p as We,q as Qe}from"./chat-input-DigALOCw.js";import{getMediaFileUrl as M}from"./constants-DsRtbZij.js";const Ze=[["path",{d:"M2 10v3",key:"1fnikh"}],["path",{d:"M6 6v11",key:"11sgs0"}],["path",{d:"M10 3v18",key:"yhl04a"}],["path",{d:"M14 8v7",key:"3a1oy3"}],["path",{d:"M18 5v13",key:"123xd1"}],["path",{d:"M22 10v3",key:"154ddg"}]],Pe=z("audio-lines",Ze);const Xe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Me=z("circle-alert",Xe);const Ye=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],es=z("circle-check",Ye);const ss=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],se=z("download",ss);const as=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],is=z("file",as);const ts=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],De=z("maximize-2",ts);const os=[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]],ne=z("pin",os);const rs=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],K=z("refresh-ccw",rs);async function ms(s){return new Promise(r=>{const t=document.createElement("video");t.crossOrigin="anonymous",t.muted=!0,t.preload="metadata";const l=setTimeout(()=>{h(),r(null)},1e4);function h(){clearTimeout(l),t.removeEventListener("loadeddata",d),t.removeEventListener("error",w),t.src="",t.load()}function w(){console.warn("[VideoThumbnail] ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð²Ð¸Ð´ÐµÐ¾:",s),h(),r(null)}function d(){t.currentTime=.1}t.addEventListener("error",w),t.addEventListener("loadeddata",d),t.addEventListener("seeked",()=>{try{const u=document.createElement("canvas"),p=400,I=Math.min(p/t.videoWidth,p/t.videoHeight,1);u.width=t.videoWidth*I,u.height=t.videoHeight*I;const v=u.getContext("2d");if(!v){h(),r(null);return}v.drawImage(t,0,0,u.width,u.height);const x=u.toDataURL("image/jpeg",.8);h(),r(x)}catch(u){console.warn("[VideoThumbnail] ÐžÑˆÐ¸Ð±ÐºÐ° Ð¸Ð·Ð²Ð»ÐµÑ‡ÐµÐ½Ð¸Ñ ÐºÐ°Ð´Ñ€Ð°:",u),h(),r(null)}}),t.src=s})}const Ie=new Set;function ns(s){return Ie.has(s)}function ls(s){Ie.add(s)}function cs(s){Ie.delete(s)}function le({file:s,showDelete:r=!1,className:t,onAttach:l}){const[h,w]=o.useState(!1),[d,{isLoading:u}]=fe(),p=s.path?M(s.path):s.url||null,I=s.previewUrl||(s.previewPath?M(s.previewPath):null)||s.url||p;async function v(){try{await d(s.id).unwrap()}catch(S){console.error("ÐžÑˆÐ¸Ð±ÐºÐ° ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ:",S)}}function x(){p?de(p,s.filename):console.warn("[MediaPreview] ÐÐµÐ²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ ÑÐºÐ°Ñ‡Ð°Ñ‚ÑŒ Ñ„Ð°Ð¹Ð»: Ð½ÐµÑ‚ URL Ð¸Ð»Ð¸ path",s)}return e.jsxDEV(e.Fragment,{children:[e.jsxDEV("div",{className:ae("group relative overflow-hidden rounded-xl border border-border bg-secondary",t),children:[s.type==="IMAGE"&&e.jsxDEV(ds,{src:I||"",alt:s.filename,onClick:()=>w(!0)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:86,columnNumber:11},this),s.type==="VIDEO"&&e.jsxDEV(us,{fileId:s.id,previewUrl:s.previewUrl||s.previewPath,originalUrl:p||"",filename:s.filename},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:94,columnNumber:11},this),s.type==="AUDIO"&&e.jsxDEV(ps,{originalUrl:p||"",filename:s.filename},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:103,columnNumber:11},this),s.type!=="VIDEO"&&s.type!=="AUDIO"&&e.jsxDEV("div",{className:"absolute inset-0 flex items-center justify-center gap-2 bg-black/50 opacity-0 transition-opacity group-hover:opacity-100",children:[s.type==="IMAGE"&&e.jsxDEV(b,{size:"icon",variant:"secondary",className:"h-8 w-8",onClick:()=>w(!0),children:e.jsxDEV(De,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:116,columnNumber:17},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:110,columnNumber:15},this),e.jsxDEV(b,{size:"icon",variant:"secondary",className:"h-8 w-8",onClick:x,children:e.jsxDEV(se,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:126,columnNumber:15},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:120,columnNumber:13},this),r&&e.jsxDEV(b,{size:"icon",variant:"destructive",className:"h-8 w-8",onClick:v,disabled:u,children:e.jsxDEV(W,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:137,columnNumber:17},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:130,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:108,columnNumber:11},this),s.type==="VIDEO"&&r&&e.jsxDEV("div",{className:"absolute right-2 top-2 z-10",children:e.jsxDEV(b,{size:"icon",variant:"destructive",className:"h-8 w-8 bg-black/70 hover:bg-red-600/80",onClick:v,disabled:u,children:e.jsxDEV(W,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:153,columnNumber:15},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:146,columnNumber:13},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:145,columnNumber:11},this),e.jsxDEV("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-2",children:e.jsxDEV("div",{className:"flex items-center justify-between",children:[e.jsxDEV(Ns,{type:s.type},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:161,columnNumber:13},this),e.jsxDEV("span",{className:"text-xs text-muted-foreground",children:Je(s.size||0)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:162,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:160,columnNumber:11},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:159,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:78,columnNumber:7},this),s.type==="IMAGE"&&e.jsxDEV(we,{open:h,onOpenChange:w,children:e.jsxDEV(xe,{showCloseButton:!1,className:"max-h-[95vh] max-w-[95vw] overflow-hidden border-border bg-background p-0",children:[e.jsxDEV(ve,{className:"sr-only",children:["ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ: ",s.filename]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:176,columnNumber:13},this),e.jsxDEV("div",{className:"relative",children:[e.jsxDEV("img",{src:p||s.url||"",alt:s.filename,className:"max-h-[90vh] w-full object-contain"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:180,columnNumber:15},this),e.jsxDEV("div",{className:"absolute right-2 top-2 flex gap-2",children:[e.jsxDEV(b,{size:"icon",variant:"secondary",onClick:x,children:e.jsxDEV(se,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:191,columnNumber:19},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:186,columnNumber:17},this),e.jsxDEV(b,{size:"icon",variant:"secondary",onClick:()=>w(!1),children:e.jsxDEV(ce,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:198,columnNumber:19},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:193,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:185,columnNumber:15},this),e.jsxDEV("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-4",children:e.jsxDEV("div",{className:"flex items-center justify-between text-white",children:[e.jsxDEV("span",{className:"font-medium text-foreground",children:s.filename},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:203,columnNumber:19},this),e.jsxDEV("span",{className:"text-sm text-muted-foreground",children:bs(s.width,s.height)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:204,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:202,columnNumber:17},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:201,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:179,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:172,columnNumber:11},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:171,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:77,columnNumber:5},this)}function ds({src:s,alt:r,onClick:t}){const[l,h]=o.useState(!1),[w,d]=o.useState(!1);return e.jsxDEV("div",{className:"relative aspect-square cursor-pointer overflow-hidden",onClick:t,children:[!l&&!w&&e.jsxDEV("div",{className:"absolute inset-0 flex items-center justify-center bg-secondary",children:e.jsxDEV(ge,{className:"h-8 w-8 animate-pulse text-muted-foreground/50"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:235,columnNumber:11},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:234,columnNumber:9},this),w?e.jsxDEV("div",{className:"flex h-full items-center justify-center bg-secondary",children:e.jsxDEV(is,{className:"h-8 w-8 text-muted-foreground/50"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:240,columnNumber:11},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:239,columnNumber:9},this):e.jsxDEV("img",{src:s,alt:r,loading:"lazy",className:ae("h-full w-full object-cover transition-opacity",l?"opacity-100":"opacity-0"),onLoad:()=>h(!0),onError:()=>d(!0)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:243,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:229,columnNumber:5},this)}function us({fileId:s,previewUrl:r,originalUrl:t,filename:l}){const[h,w]=o.useState(!1),[d,u]=o.useState(!1),[p,I]=o.useState(!1),[v,x]=o.useState(!1),[S,f]=o.useState(null),T=o.useRef(!1),[g]=Le(),E=(r?.startsWith("__pending__")??!1)&&r?r.replace("__pending__",""):r;o.useEffect(()=>{if(r||v||T.current||ns(s))return;async function C(){T.current=!0,ls(s),x(!0);try{const P=await ms(t);P&&(f(P),g({fileId:s,thumbnail:P}).catch(n=>{console.warn("[VideoPreview] ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ thumbnail Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€:",n)}))}catch(P){console.warn("[VideoPreview] ÐžÑˆÐ¸Ð±ÐºÐ° Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¸ thumbnail:",P)}finally{x(!1),cs(s)}}C()},[s,r,t,v,g]);function J(){w(!0)}const A=E?E.startsWith("data:")||E.startsWith("http://")||E.startsWith("https://")?E:M(E):S;return h?e.jsxDEV("div",{className:"group/video relative aspect-square",children:e.jsxDEV("video",{src:t,poster:A||void 0,controls:!0,className:"h-full w-full object-cover video-controls-on-hover"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:356,columnNumber:9},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:355,columnNumber:7},this):v&&!S?e.jsxDEV("div",{className:"relative aspect-square cursor-pointer overflow-hidden",onClick:J,children:[e.jsxDEV(ee,{className:"h-full w-full rounded-none"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:373,columnNumber:9},this),e.jsxDEV("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxDEV("div",{className:"rounded-full bg-white/20 p-4 backdrop-blur-sm animate-pulse",children:e.jsxDEV(X,{className:"h-8 w-8 text-white"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:376,columnNumber:13},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:375,columnNumber:11},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:374,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:369,columnNumber:7},this):!A||p?e.jsxDEV("div",{className:"relative aspect-square cursor-pointer overflow-hidden bg-secondary",onClick:J,children:e.jsxDEV("div",{className:"absolute inset-0 flex flex-col items-center justify-center gap-3",children:[e.jsxDEV("div",{className:"rounded-full bg-white/20 p-6 backdrop-blur-sm",children:e.jsxDEV(X,{className:"h-12 w-12 text-white"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:392,columnNumber:13},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:391,columnNumber:11},this),e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ Ð´Ð»Ñ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ñ"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:394,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:390,columnNumber:9},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:386,columnNumber:7},this):e.jsxDEV("div",{className:"relative aspect-square cursor-pointer overflow-hidden",onClick:J,children:[e.jsxDEV("img",{src:A,alt:l,loading:"lazy",className:ae("h-full w-full object-cover transition-opacity",d?"opacity-100":"opacity-0"),onLoad:()=>u(!0),onError:()=>{I(!0)}},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:406,columnNumber:7},this),!d&&e.jsxDEV("div",{className:"absolute inset-0 flex items-center justify-center bg-secondary",children:e.jsxDEV(X,{className:"h-8 w-8 animate-pulse text-muted-foreground/50"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:421,columnNumber:11},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:420,columnNumber:9},this),e.jsxDEV("div",{className:"absolute inset-0 bg-black/0 transition-colors hover:bg-black/10"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:425,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:402,columnNumber:5},this)}function ps({originalUrl:s,filename:r}){return e.jsxDEV("div",{className:"flex aspect-video flex-col items-center justify-center gap-3 bg-secondary p-4",children:[e.jsxDEV(Pe,{className:"h-12 w-12 text-primary"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:440,columnNumber:7},this),e.jsxDEV("p",{className:"text-xs text-muted-foreground text-center max-w-full truncate",children:r},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:441,columnNumber:7},this),e.jsxDEV("audio",{src:s,controls:!0,className:"w-full"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:444,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:439,columnNumber:5},this)}function Ns({type:s}){const r={IMAGE:{icon:ge},VIDEO:{icon:X},AUDIO:{icon:Pe}},{icon:t}=r[s];return e.jsxDEV(t,{className:"h-4 w-4 text-muted-foreground"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-preview.tsx",lineNumber:467,columnNumber:10},this)}function bs(s,r){return s&&r?`${s} Ã— ${r}`:""}function hs({status:s}){const r={PENDING:{icon:$,label:"ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ°",className:"bg-blue-900/30 text-blue-400"},PROCESSING:{icon:$,label:"Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ",className:"bg-blue-900/30 text-blue-400"},COMPLETED:{icon:es,label:"Ð“Ð¾Ñ‚Ð¾Ð²Ð¾",className:"bg-green-900/30 text-green-400"},FAILED:{icon:Me,label:"ÐžÑˆÐ¸Ð±ÐºÐ°",className:"bg-red-900/30 text-red-400"}},{icon:t,label:l,className:h}=r[s],w=s==="PROCESSING"||s==="PENDING";return e.jsxDEV(Ge,{variant:"secondary",className:h,children:[e.jsxDEV(t,{className:`mr-1 h-3 w-3 ${w?"animate-spin":""}`},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/status-badge.tsx",lineNumber:39,columnNumber:13},this),l]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/status-badge.tsx",lineNumber:38,columnNumber:9},this)}function fs({request:s,onEditPrompt:r,onAttachFile:t,onRepeatRequest:l}){const[h,{isLoading:w}]=fe(),{data:d}=Ve(),[u,p]=o.useState(null),[I,v]=o.useState(!1),[x,S]=o.useState(!1),[f,T]=o.useState(!1),g=o.useRef(null),U=o.useMemo(()=>Ce(v),[]);o.useEffect(()=>{if(g.current){const{scrollHeight:n,clientHeight:k}=g.current;T(n>k)}},[s.prompt]);function E(n){return n?d?.find(k=>k.key===n):null}const J=E(s.model),A=J?.provider?Be(J.provider):null;async function C(n,k){n.stopPropagation();try{await h(k).unwrap()}catch(D){console.error("ÐžÑˆÐ¸Ð±ÐºÐ° ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ Ñ„Ð°Ð¹Ð»Ð°:",D)}}function P(){return s.status==="FAILED"?"bg-destructive/10 border border-destructive/20":"bg-secondary/40 border border-border/50"}return e.jsxDEV("div",{className:"space-y-3",children:[e.jsxDEV("div",{className:"group flex items-start justify-end gap-2",children:[e.jsxDEV("div",{className:"flex flex-col gap-1",children:[r&&e.jsxDEV(b,{type:"button",size:"icon",variant:"ghost",className:"h-8 w-8 shrink-0 text-primary opacity-0 transition-opacity hover:text-primary/80 hover:bg-primary/20 group-hover:opacity-100",onClick:()=>r(s.prompt),title:"Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¾Ð¼Ð¿Ñ‚",children:e.jsxDEV("span",{className:"text-lg",children:"âœ¨"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:116,columnNumber:29},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:108,columnNumber:25},this),l&&e.jsxDEV(b,{type:"button",size:"icon",variant:"ghost",className:"h-8 w-8 shrink-0 text-muted-foreground opacity-0 transition-opacity hover:text-primary hover:bg-primary/20 focus:text-primary focus:bg-primary/20 group-hover:opacity-100",onClick:()=>l(s),title:"ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ð¸Ñ‚ÑŒ Ð·Ð°Ð¿Ñ€Ð¾Ñ Ðº Ð½ÐµÐ¹Ñ€Ð¾Ð½ÐºÐµ",children:e.jsxDEV(K,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:129,columnNumber:29},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:121,columnNumber:25},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:105,columnNumber:17},this),e.jsxDEV("div",{className:"max-w-[80%] rounded-2xl rounded-tr-sm bg-primary px-4 py-3 shadow-sm",children:[e.jsxDEV("div",{className:"relative",children:[e.jsxDEV("p",{ref:g,className:`whitespace-pre-wrap text-sm text-primary-foreground transition-all duration-200 ${x?"":"line-clamp-2"}`,children:s.prompt},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:135,columnNumber:25},this),f&&e.jsxDEV("button",{onClick:()=>S(!x),className:"mt-1 text-xs font-medium text-primary-foreground/80 hover:text-primary-foreground transition-colors",children:x?"Ð¡Ð²ÐµÑ€Ð½ÑƒÑ‚ÑŒ":"ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð¿Ð¾Ð»Ð½Ð¾ÑÑ‚ÑŒÑŽ"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:144,columnNumber:29},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:134,columnNumber:21},this),s.inputFiles&&s.inputFiles.length>0&&e.jsxDEV("div",{className:"mt-2 flex flex-wrap gap-2",children:s.inputFiles.map((n,k)=>{if(!n)return null;const D=n.startsWith("data:"),Q=n.startsWith("http://")||n.startsWith("https://");if(!D&&!Q)return null;const F=D?He(n):!1;return e.jsxDEV("div",{className:"h-16 w-16 overflow-hidden rounded-lg border border-primary-foreground/20",children:F?e.jsxDEV("video",{src:n,className:"h-full w-full object-cover"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:185,columnNumber:45},this):e.jsxDEV("img",{src:n,alt:`ÐŸÑ€Ð¸ÐºÑ€ÐµÐ¿Ð»ÐµÐ½Ð½Ñ‹Ð¹ Ñ„Ð°Ð¹Ð» ${k+1}`,className:"h-full w-full object-cover",crossOrigin:"anonymous"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:191,columnNumber:45},this)},k,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:180,columnNumber:37},this)})},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:154,columnNumber:25},this),e.jsxDEV("div",{className:"mt-1 flex items-center justify-end gap-2 text-xs text-primary-foreground/70",children:[J&&e.jsxDEV("span",{className:"flex items-center gap-1",children:[J.name,A&&e.jsxDEV("span",{className:"text-primary-foreground/50",children:["â€¢ ",A]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:208,columnNumber:37},this),s.seed&&e.jsxDEV("span",{className:"text-primary-foreground/50",children:["â€¢ Seed: ",s.seed]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:213,columnNumber:37},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:205,columnNumber:29},this),e.jsxDEV("span",{children:pe(s.createdAt)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:219,columnNumber:25},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:203,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:133,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:103,columnNumber:13},this),e.jsxDEV("div",{className:"flex justify-start",children:e.jsxDEV("div",{className:"max-w-[80%] space-y-3",children:[(s.status!=="COMPLETED"||s.status==="COMPLETED"&&s.files.length===0)&&e.jsxDEV("div",{className:`rounded-2xl rounded-tl-sm px-4 py-3 ${P()}`,children:[e.jsxDEV(hs,{status:s.status},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:235,columnNumber:29},this),s.status==="FAILED"&&s.errorMessage&&e.jsxDEV("div",{className:"mt-2 flex items-start gap-2 rounded-lg bg-destructive/10 p-3 text-destructive",children:[e.jsxDEV(Me,{className:"mt-0.5 h-4 w-4 shrink-0"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:241,columnNumber:41},this),e.jsxDEV("p",{className:"min-w-0 flex-1 text-xs whitespace-pre-wrap break-all overflow-x-auto",children:s.errorMessage},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:242,columnNumber:41},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:240,columnNumber:37},this),(s.status==="PENDING"||s.status==="PROCESSING")&&e.jsxDEV("div",{className:"mt-3 space-y-3",children:[e.jsxDEV(ee,{className:"aspect-square w-48 rounded-xl"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:253,columnNumber:37},this),e.jsxDEV("div",{hidden:!0,className:"flex items-center gap-2 text-slate-400",children:[e.jsxDEV($,{className:"h-4 w-4 animate-spin"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:258,columnNumber:41},this),e.jsxDEV("span",{className:"text-sm",children:s.status==="PENDING"?"ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ°":"Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:259,columnNumber:41},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:254,columnNumber:37},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:251,columnNumber:33},this),s.status==="COMPLETED"&&s.files.length===0&&e.jsxDEV("div",{className:"mt-2 rounded-lg bg-primary/10 p-3 text-primary",children:e.jsxDEV("p",{className:"text-sm",children:"âš ï¸ Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð°, Ð½Ð¾ Ñ„Ð°Ð¹Ð»Ñ‹ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ñ‹"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:272,columnNumber:41},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:271,columnNumber:37},this),s.completedAt&&e.jsxDEV("p",{className:"mt-2 text-xs text-slate-500",children:["Ð—Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¾: ",pe(s.completedAt)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:281,columnNumber:33},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:231,columnNumber:25},this),s.status==="COMPLETED"&&s.files.length>0&&e.jsxDEV("div",{className:"space-y-3",children:[e.jsxDEV("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:s.files.map(n=>e.jsxDEV("div",{className:"group flex items-start gap-2",children:[e.jsxDEV("div",{className:`inline-block w-fit rounded-2xl rounded-tl-sm p-2 ${P()}`,children:e.jsxDEV(le,{file:n,onAttach:t},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:302,columnNumber:53},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:299,columnNumber:49},this),e.jsxDEV("div",{className:"mt-1 flex flex-col gap-1",children:[n.type==="IMAGE"&&t&&e.jsxDEV(b,{type:"button",size:"icon",variant:"ghost",className:"h-8 w-8 shrink-0 text-muted-foreground opacity-0 transition-opacity hover:text-primary hover:bg-primary/10 group-hover:opacity-100",onClick:()=>{if(!n.path)return;U();const k=M(n.path);t(k,n.filename)},title:"ÐŸÑ€Ð¸ÐºÑ€ÐµÐ¿Ð¸Ñ‚ÑŒ Ðº Ð¿Ñ€Ð¾Ð¼Ð¿Ñ‚Ñƒ",children:I?e.jsxDEV($,{className:"h-4 w-4 animate-spin"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:335,columnNumber:69},this):e.jsxDEV(Y,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:337,columnNumber:69},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:312,columnNumber:61},this),e.jsxDEV(b,{type:"button",size:"icon",variant:"ghost",className:"h-8 w-8 shrink-0 text-slate-400 opacity-0 transition-opacity hover:text-red-400 hover:bg-red-600/20 group-hover:opacity-100",onClick:k=>C(k,n.id),disabled:w,title:"Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ñ„Ð°Ð¹Ð»",children:e.jsxDEV(W,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:356,columnNumber:57},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:342,columnNumber:53},this),n.type==="VIDEO"&&e.jsxDEV(b,{type:"button",size:"icon",variant:"ghost",className:"h-8 w-8 shrink-0 text-muted-foreground opacity-0 transition-opacity hover:text-primary hover:bg-primary/10 group-hover:opacity-100",onClick:()=>p(n),title:"ÐžÑ‚ÐºÑ€Ñ‹Ñ‚ÑŒ Ð½Ð° Ð²ÐµÑÑŒ ÑÐºÑ€Ð°Ð½",children:e.jsxDEV(De,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:372,columnNumber:61},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:360,columnNumber:57},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:308,columnNumber:49},this)]},n.id,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:295,columnNumber:45},this))},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:292,columnNumber:33},this),s.completedAt&&e.jsxDEV("p",{className:"text-xs text-slate-500",children:["Ð—Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¾:"," ",pe(s.completedAt)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:382,columnNumber:37},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:291,columnNumber:29},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:226,columnNumber:17},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:225,columnNumber:13},this),u&&e.jsxDEV(we,{open:!!u,onOpenChange:n=>!n&&p(null),children:e.jsxDEV(xe,{showCloseButton:!1,className:"max-h-[95vh] max-w-[95vw] overflow-hidden border-border bg-background p-0",children:[e.jsxDEV(ve,{className:"sr-only",children:["ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ Ð²Ð¸Ð´ÐµÐ¾: ",u.filename]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:402,columnNumber:25},this),e.jsxDEV("div",{className:"relative",children:[e.jsxDEV("video",{src:u.path?M(u.path):"",controls:!0,autoPlay:!0,className:"max-h-[90vh] w-full"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:406,columnNumber:29},this),e.jsxDEV("div",{className:"absolute right-2 top-2 flex gap-2",children:[e.jsxDEV(b,{size:"icon",variant:"secondary",onClick:()=>{u.path&&de(M(u.path),u.filename)},children:e.jsxDEV(se,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:431,columnNumber:37},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:418,columnNumber:33},this),e.jsxDEV(b,{size:"icon",variant:"secondary",onClick:()=>p(null),children:e.jsxDEV(ce,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:438,columnNumber:37},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:433,columnNumber:33},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:417,columnNumber:29},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:405,columnNumber:25},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:398,columnNumber:21},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:394,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-item.tsx",lineNumber:101,columnNumber:9},this)}function be(){return e.jsxDEV("div",{className:"mb-6 space-y-3",children:[e.jsxDEV("div",{className:"flex justify-end",children:e.jsxDEV(ee,{className:"h-16 w-64 rounded-2xl"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-skeleton.tsx",lineNumber:8,columnNumber:17},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-skeleton.tsx",lineNumber:7,columnNumber:13},this),e.jsxDEV("div",{className:"flex justify-start",children:e.jsxDEV(ee,{className:"h-48 w-80 rounded-2xl"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-skeleton.tsx",lineNumber:11,columnNumber:17},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-skeleton.tsx",lineNumber:10,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-skeleton.tsx",lineNumber:6,columnNumber:9},this)}function ws({requests:s,chatModel:r,isLoading:t,onEditPrompt:l,onAttachFile:h,onRepeatRequest:w}){const d=o.useRef(null),u=o.useRef(null),p=o.useMemo(()=>s.map(f=>`${f.id}-${f.status}`).join("|"),[s]),[I,v]=o.useState(!1),x=o.useCallback(()=>{if(d.current){const{scrollTop:f,scrollHeight:T,clientHeight:g}=d.current,U=T-f-g<200;v(!U)}},[]);o.useEffect(()=>{const f=d.current;if(f)return f.addEventListener("scroll",x),()=>f.removeEventListener("scroll",x)},[x]),o.useEffect(()=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{u.current&&u.current.scrollIntoView({behavior:"smooth"})})})},[s.length,p]);const S=()=>{u.current&&u.current.scrollIntoView({behavior:"smooth"})};return t?e.jsxDEV("div",{className:"flex-1 p-4",children:[e.jsxDEV(be,{},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-list.tsx",lineNumber:84,columnNumber:17},this),e.jsxDEV(be,{},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-list.tsx",lineNumber:85,columnNumber:17},this),e.jsxDEV(be,{},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-list.tsx",lineNumber:86,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-list.tsx",lineNumber:83,columnNumber:13},this):s.length===0?e.jsxDEV("div",{className:"flex flex-1 flex-col items-center justify-center p-8 text-center",children:[e.jsxDEV("div",{className:"mb-4 rounded-full bg-secondary p-6",children:e.jsxDEV("span",{className:"text-4xl",children:"ðŸŽ¨"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-list.tsx",lineNumber:95,columnNumber:21},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-list.tsx",lineNumber:94,columnNumber:17},this),e.jsxDEV("h3",{className:"mb-2 text-xl font-semibold text-white",children:"ÐÐ°Ñ‡Ð½Ð¸Ñ‚Ðµ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸ÑŽ"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-list.tsx",lineNumber:97,columnNumber:17},this),e.jsxDEV("p",{className:"max-w-md text-slate-400",children:"Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð¿Ñ€Ð¾Ð¼Ð¿Ñ‚ Ð¸ Ð½Ð°Ð¶Ð¼Ð¸Ñ‚Ðµ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ ÑÐ³ÐµÐ½ÐµÑ€Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ, Ð²Ð¸Ð´ÐµÐ¾ Ð¸Ð»Ð¸ Ð°ÑƒÐ´Ð¸Ð¾ Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ AI"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-list.tsx",lineNumber:100,columnNumber:17},this),e.jsxDEV("div",{className:"mt-4",children:e.jsxDEV(qe,{model:r},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-list.tsx",lineNumber:105,columnNumber:21},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-list.tsx",lineNumber:104,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-list.tsx",lineNumber:93,columnNumber:13},this):e.jsxDEV("div",{className:"relative flex-1 overflow-hidden",children:[e.jsxDEV(he,{className:"h-full bg-background",ref:d,children:e.jsxDEV("div",{className:"space-y-6 p-4",children:[s.map(f=>e.jsxDEV(fs,{request:f,onEditPrompt:l,onAttachFile:h,onRepeatRequest:w},f.id,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-list.tsx",lineNumber:116,columnNumber:25},this)),e.jsxDEV("div",{ref:u},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-list.tsx",lineNumber:125,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-list.tsx",lineNumber:114,columnNumber:17},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-list.tsx",lineNumber:113,columnNumber:13},this),I&&e.jsxDEV(b,{size:"icon",variant:"secondary",className:"absolute bottom-4 right-8 z-10 h-10 w-10 rounded-full bg-secondary/80 text-foreground shadow-lg backdrop-blur-sm hover:bg-secondary",onClick:S,children:e.jsxDEV(re,{className:"h-6 w-6"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-list.tsx",lineNumber:136,columnNumber:21},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-list.tsx",lineNumber:130,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/message-list.tsx",lineNumber:112,columnNumber:9},this)}function xs({file:s,onClose:r,onAttachFile:t,onRepeatRequest:l,isPinned:h=!1,onTogglePin:w}){if(s.type==="VIDEO"&&!s.path||s.type==="IMAGE"&&!s.path&&!s.url)return null;const d=s.type==="VIDEO"?M(s.path):s.path?M(s.path):s.url||"";o.useEffect(()=>{function p(I){I.key==="Escape"&&r()}return document.addEventListener("keydown",p),()=>document.removeEventListener("keydown",p)},[r]);function u(){de(d,s.filename)}return e.jsxDEV("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-background/95 backdrop-blur-sm",onClick:r,children:e.jsxDEV("div",{className:"relative max-h-[95vh] max-w-[95vw]",onClick:p=>p.stopPropagation(),children:[s.type==="IMAGE"&&e.jsxDEV("img",{src:d,alt:s.filename,className:"max-h-[90vh] max-w-[90vw] object-contain rounded-lg shadow-2xl"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-fullscreen-view.tsx",lineNumber:66,columnNumber:21},this),s.type==="VIDEO"&&s.path&&e.jsxDEV("div",{className:"relative rounded-lg overflow-hidden shadow-2xl",children:e.jsxDEV("video",{src:d,controls:!0,autoPlay:!0,className:"max-h-[90vh] w-full"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-fullscreen-view.tsx",lineNumber:75,columnNumber:25},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-fullscreen-view.tsx",lineNumber:74,columnNumber:21},this),s.type==="AUDIO"&&e.jsxDEV("div",{className:"flex flex-col items-center gap-4 rounded-xl bg-secondary p-8 shadow-2xl border border-border",children:[e.jsxDEV("audio",{src:d,controls:!0},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-fullscreen-view.tsx",lineNumber:86,columnNumber:25},this),e.jsxDEV("p",{className:"text-foreground font-medium",children:s.filename},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-fullscreen-view.tsx",lineNumber:87,columnNumber:25},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-fullscreen-view.tsx",lineNumber:85,columnNumber:21},this),e.jsxDEV("div",{className:"absolute right-2 top-2 flex gap-2",children:[s.type==="IMAGE"&&t&&e.jsxDEV(b,{size:"icon",variant:"secondary",onClick:p=>{p.stopPropagation(),t(d,s.filename)},className:"h-8 w-8 hover:bg-primary hover:text-primary-foreground",title:"ÐŸÑ€Ð¸ÐºÑ€ÐµÐ¿Ð¸Ñ‚ÑŒ Ðº Ð¿Ñ€Ð¾Ð¼Ð¿Ñ‚Ñƒ",children:e.jsxDEV(Y,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-fullscreen-view.tsx",lineNumber:105,columnNumber:29},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-fullscreen-view.tsx",lineNumber:95,columnNumber:25},this),l&&e.jsxDEV(b,{size:"icon",variant:"secondary",onClick:p=>{p.stopPropagation(),l(s.requestId)},className:"h-8 w-8 text-muted-foreground hover:text-primary",title:"ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ð¸Ñ‚ÑŒ Ð·Ð°Ð¿Ñ€Ð¾Ñ",children:e.jsxDEV(K,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-fullscreen-view.tsx",lineNumber:120,columnNumber:29},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-fullscreen-view.tsx",lineNumber:110,columnNumber:25},this),e.jsxDEV(b,{size:"icon",variant:"secondary",onClick:p=>{p.stopPropagation(),u()},className:"h-8 w-8 hover:bg-secondary/80",title:"Ð¡ÐºÐ°Ñ‡Ð°Ñ‚ÑŒ Ñ„Ð°Ð¹Ð»",children:e.jsxDEV(se,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-fullscreen-view.tsx",lineNumber:133,columnNumber:25},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-fullscreen-view.tsx",lineNumber:123,columnNumber:21},this),s.type==="IMAGE"&&w&&e.jsxDEV(b,{size:"icon",variant:"secondary",onClick:p=>{p.stopPropagation(),w()},className:`h-8 w-8 ${h?"text-primary hover:text-primary/80":""}`,title:h?"ÐžÑ‚ÐºÑ€ÐµÐ¿Ð¸Ñ‚ÑŒ":"Ð—Ð°ÐºÑ€ÐµÐ¿Ð¸Ñ‚ÑŒ",children:e.jsxDEV(ne,{className:`h-4 w-4 ${h?"fill-current":""}`},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-fullscreen-view.tsx",lineNumber:151,columnNumber:29},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-fullscreen-view.tsx",lineNumber:137,columnNumber:25},this),e.jsxDEV(b,{size:"icon",variant:"secondary",onClick:p=>{p.stopPropagation(),r()},className:"h-8 w-8",title:"Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ",children:e.jsxDEV(ce,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-fullscreen-view.tsx",lineNumber:168,columnNumber:25},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-fullscreen-view.tsx",lineNumber:158,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-fullscreen-view.tsx",lineNumber:92,columnNumber:17},this),e.jsxDEV("div",{className:"absolute bottom-0 left-0 right-0 bg-linear-to-t from-black/80 to-transparent p-4",children:e.jsxDEV("div",{className:"flex items-center justify-between text-white",children:[e.jsxDEV("span",{className:"font-medium",children:s.filename},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-fullscreen-view.tsx",lineNumber:175,columnNumber:25},this),s.size&&e.jsxDEV("span",{className:"text-sm text-slate-300",children:Je(s.size)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-fullscreen-view.tsx",lineNumber:177,columnNumber:29},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-fullscreen-view.tsx",lineNumber:174,columnNumber:21},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-fullscreen-view.tsx",lineNumber:173,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-fullscreen-view.tsx",lineNumber:61,columnNumber:13},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-fullscreen-view.tsx",lineNumber:57,columnNumber:9},this)}const vs={NANO_BANANA_OPENROUTER:.05,NANO_BANANA_PRO_KIEAI:.09,NANO_BANANA_PRO_LAOZHANG:.05,IMAGEN4_KIEAI:.02,IMAGEN4_ULTRA_KIEAI:.06,SEEDREAM_4_5:.0325,SEEDREAM_4_5_EDIT:.0325,KLING_2_5_TURBO_PRO:.42,KLING_2_6:.55,VEO_3_1_FAST:.3,VEO_3_1:1.25,ELEVENLABS_MULTILINGUAL_V2:.05,MIDJOURNEY:.5,SORA_2:.3};function gs(s){return!s.model||s.status==="FAILED"?0:vs[s.model]||0}function Ds(s){return s.reduce((r,t)=>r+gs(t),0)}function Is(s){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:4}).format(s)}const Es=12;function ks({chatId:s,onAttachFile:r,onRepeatRequest:t}){const[l,h]=o.useState(null),[w,{isLoading:d}]=fe(),[u,p]=o.useState(1),[I,v]=o.useState([]),x=o.useRef(null),[S,f]=o.useState(!0),[T,g]=o.useState(!0),[U,E]=o.useState(!0),[J,A]=o.useState(!1),[C,P]=o.useState(new Set),n=o.useRef(new Set),k=o.useMemo(()=>Ce(A),[]);o.useEffect(()=>{n.current=C},[C]),o.useEffect(()=>{if(s===void 0)return;const m=`pinned-images-chat-${s}`,a=localStorage.getItem(m);if(a)try{const N=JSON.parse(a),i=new Set(N);P(i),n.current=i}catch(N){console.error("Error loading pinned images:",N)}else{const N=new Set;P(N),n.current=N}},[s]),o.useEffect(()=>{p(1),v([])},[s]);const{data:D,isLoading:Q,isFetching:F}=Fe({page:u,limit:50,chatId:s},{skip:s===void 0}),{data:L}=Ue({id:s,limit:1e3},{skip:s===void 0}),_=o.useMemo(()=>L?.requests?Ds(L.requests):0,[L?.requests]);o.useEffect(()=>{D?.data&&v(u===1?m=>{const a=new Set(D.data.map(c=>c.id)),N=n.current;return[...m.filter(c=>N.has(c.id)&&!a.has(c.id)),...D.data]}:m=>{const a=new Set(m.map(i=>i.id)),N=D.data.filter(i=>!a.has(i.id));return[...m,...N]})},[D,u]),o.useEffect(()=>{!L?.requests||C.size===0||v(m=>{const a=new Set(m.map(c=>c.id)),N=n.current,i=[];return L.requests.forEach(c=>{c.files.forEach(j=>{N.has(j.id)&&!a.has(j.id)&&i.push(j)})}),i.length===0?m:[...i,...m]})},[L,C]);const G=o.useMemo(()=>I,[I]);function H(m){P(a=>{const N=new Set(a);if(N.has(m)?N.delete(m):N.add(m),s!==void 0){const i=`pinned-images-chat-${s}`;localStorage.setItem(i,JSON.stringify(Array.from(N)))}return N})}const{videoFiles:B,pinnedImages:Z,unpinnedImages:R}=o.useMemo(()=>{const m=[],a=[],N=[];return G.forEach(i=>{i.type==="VIDEO"?m.push(i):i.type==="IMAGE"&&(C.has(i.id)?a.push(i):N.push(i))}),{videoFiles:m,pinnedImages:a,unpinnedImages:N}},[G,C]),Ee=o.useMemo(()=>B,[B]),ie=o.useMemo(()=>Z,[Z]),ue=o.useMemo(()=>R,[R]);o.useEffect(()=>{if(!x.current||F||!(D?.pagination&&D.pagination.page<D.pagination.totalPages))return;const a=new IntersectionObserver(N=>{N[0].isIntersecting&&p(i=>i+1)},{threshold:.1});return a.observe(x.current),()=>{a.disconnect()}},[F,D]);function O(m){h(m)}async function q(m,a){m.stopPropagation(),v(N=>N.filter(i=>i.id!==a));try{await w(a).unwrap()}catch(N){console.error("ÐžÑˆÐ¸Ð±ÐºÐ° ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ Ñ„Ð°Ð¹Ð»Ð°:",N)}}return Q?e.jsxDEV("div",{className:"flex h-full w-[30%] flex-col border-l border-border bg-background",children:[e.jsxDEV("div",{className:me,children:e.jsxDEV("h2",{className:Ne,children:"ÐœÐµÐ´Ð¸Ð°Ñ„Ð°Ð¹Ð»Ñ‹"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:306,columnNumber:21},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:305,columnNumber:17},this),e.jsxDEV(he,{className:"flex-1",children:e.jsxDEV("div",{className:"grid grid-cols-3 gap-2 p-4",children:Array.from({length:Es}).map((m,a)=>e.jsxDEV(ee,{className:"aspect-square w-full rounded-xl"},`skeleton-${a}`,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:312,columnNumber:33},this))},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:309,columnNumber:21},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:308,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:304,columnNumber:13},this):G.length===0?e.jsxDEV("div",{className:"flex h-full w-[30%] flex-col border-l border-border bg-background",children:[e.jsxDEV("div",{className:me,children:e.jsxDEV("h2",{className:Ne,children:"ÐœÐµÐ´Ð¸Ð°Ñ„Ð°Ð¹Ð»Ñ‹"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:328,columnNumber:21},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:327,columnNumber:17},this),e.jsxDEV("div",{className:"flex flex-1 items-center justify-center",children:e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"ÐÐµÑ‚ Ð¼ÐµÐ´Ð¸Ð°Ñ„Ð°Ð¹Ð»Ð¾Ð²"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:331,columnNumber:21},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:330,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:326,columnNumber:13},this):e.jsxDEV(e.Fragment,{children:[e.jsxDEV("div",{className:"flex h-full w-[30%] flex-col border-l border-border bg-background",children:[e.jsxDEV("div",{className:ae(me,"flex-row items-center justify-between bg-background"),children:[e.jsxDEV("h2",{className:Ne,children:["ÐœÐµÐ´Ð¸Ð°Ñ„Ð°Ð¹Ð»Ñ‹ (",G.length,")"]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:347,columnNumber:21},this),_>0&&e.jsxDEV("div",{className:"text-[10px] font-medium px-2 py-0.5 rounded bg-primary/10 text-primary border border-primary/20",children:Is(_)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:351,columnNumber:25},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:341,columnNumber:17},this),e.jsxDEV(he,{className:"flex-1",children:e.jsxDEV("div",{className:"p-4 space-y-4",children:[Z.length>0&&e.jsxDEV("div",{children:[e.jsxDEV("button",{onClick:()=>E(!U),className:"flex w-full items-center justify-between rounded-lg bg-transparent px-3 py-2 text-sm font-medium text-foreground hover:bg-secondary transition-colors",children:[e.jsxDEV("div",{className:"flex gap-2 items-center",children:[e.jsxDEV(ne,{className:"h-4 w-4 text-yellow-400"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:370,columnNumber:41},this),e.jsxDEV("span",{children:["Ð—Ð°ÐºÑ€ÐµÐ¿Ð»ÐµÐ½Ð½Ñ‹Ðµ (",Z.length,")"]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:371,columnNumber:41},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:369,columnNumber:37},this),e.jsxDEV(re,{className:`h-4 w-4 transition-transform ${U?"rotate-180":""}`},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:375,columnNumber:37},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:363,columnNumber:33},this),U&&e.jsxDEV("div",{className:"grid grid-cols-3 gap-2 mt-2",children:ie.map(m=>e.jsxDEV("div",{className:"group relative cursor-pointer transition-transform hover:scale-105",onClick:a=>{a.stopPropagation(),O(m)},role:"button",tabIndex:0,onKeyDown:a=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),O(m))},children:[e.jsxDEV("div",{onClick:a=>a.stopPropagation(),children:e.jsxDEV(le,{file:m,className:"h-full w-full"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:408,columnNumber:53},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:403,columnNumber:49},this),r&&e.jsxDEV(b,{size:"icon",variant:"ghost",className:"absolute left-1 top-1 h-6 w-6 text-slate-400 opacity-0 transition-opacity hover:text-cyan-400 hover:bg-cyan-600/20 group-hover:opacity-100",onClick:a=>{if(a.stopPropagation(),!m.path)return;k();const N=M(m.path);r(N,m.filename)},title:"ÐŸÑ€Ð¸ÐºÑ€ÐµÐ¿Ð¸Ñ‚ÑŒ Ðº Ð¿Ñ€Ð¾Ð¼Ð¿Ñ‚Ñƒ",children:J?e.jsxDEV($,{className:"h-3.5 w-3.5 animate-spin"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:436,columnNumber:61},this):e.jsxDEV(Y,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:438,columnNumber:61},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:415,columnNumber:53},this),t&&e.jsxDEV(b,{size:"icon",variant:"ghost",className:"absolute left-8 top-1 h-6 w-6 text-slate-400 opacity-0 transition-opacity hover:text-cyan-400 hover:bg-cyan-600/20 focus:text-cyan-400 focus:bg-cyan-600/20 group-hover:opacity-100",onClick:a=>{a.stopPropagation(),t(m.requestId)},title:"ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ð¸Ñ‚ÑŒ Ð·Ð°Ð¿Ñ€Ð¾Ñ",children:e.jsxDEV(K,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:456,columnNumber:57},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:444,columnNumber:53},this),e.jsxDEV(b,{size:"icon",variant:"ghost",className:"absolute right-7 top-1 h-6 w-6 text-yellow-400 opacity-0 transition-opacity hover:text-yellow-300 hover:bg-yellow-600/20 group-hover:opacity-100",onClick:a=>{a.stopPropagation(),H(m.id)},title:"ÐžÑ‚ÐºÑ€ÐµÐ¿Ð¸Ñ‚ÑŒ",children:e.jsxDEV(ne,{className:"h-3.5 w-3.5 fill-current"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:470,columnNumber:53},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:460,columnNumber:49},this),e.jsxDEV(b,{size:"icon",variant:"ghost",className:"absolute right-1 top-1 h-6 w-6 text-slate-400 opacity-0 transition-opacity hover:text-red-400 hover:bg-red-600/20 group-hover:opacity-100",onClick:a=>q(a,m.id),disabled:d,title:"Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ñ„Ð°Ð¹Ð»",children:e.jsxDEV(W,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:486,columnNumber:53},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:473,columnNumber:49},this)]},m.id,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:384,columnNumber:45},this))},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:382,columnNumber:37},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:362,columnNumber:29},this),R.length>0&&e.jsxDEV("div",{children:[e.jsxDEV("button",{onClick:()=>g(!T),className:"flex w-full items-center justify-between rounded-lg bg-slate-700/0 px-3 py-2 text-sm font-medium text-slate-200 hover:bg-slate-700 transition-colors",children:[e.jsxDEV("div",{className:"flex gap-2 items-center",children:[e.jsxDEV(ge,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:505,columnNumber:41},this),e.jsxDEV("span",{children:["Ð˜Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ (",R.length,")"]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:506,columnNumber:41},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:504,columnNumber:37},this),e.jsxDEV(re,{className:`h-4 w-4 transition-transform ${T?"rotate-180":""}`},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:511,columnNumber:37},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:498,columnNumber:33},this),T&&e.jsxDEV("div",{className:"grid grid-cols-3 gap-2 mt-2",children:ue.map(m=>e.jsxDEV("div",{className:"group relative cursor-pointer transition-transform hover:scale-105",onClick:a=>{a.stopPropagation(),O(m)},role:"button",tabIndex:0,onKeyDown:a=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),O(m))},children:[e.jsxDEV("div",{onClick:a=>a.stopPropagation(),children:e.jsxDEV(le,{file:m,className:"h-full w-full"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:544,columnNumber:53},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:539,columnNumber:49},this),r&&e.jsxDEV(b,{size:"icon",variant:"ghost",className:"absolute left-1 top-1 h-6 w-6 text-slate-400 opacity-0 transition-opacity hover:text-cyan-400 hover:bg-cyan-600/20 group-hover:opacity-100",onClick:a=>{if(a.stopPropagation(),!m.path)return;k();const N=M(m.path);r(N,m.filename)},title:"ÐŸÑ€Ð¸ÐºÑ€ÐµÐ¿Ð¸Ñ‚ÑŒ Ðº Ð¿Ñ€Ð¾Ð¼Ð¿Ñ‚Ñƒ",children:J?e.jsxDEV($,{className:"h-3.5 w-3.5 animate-spin"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:572,columnNumber:61},this):e.jsxDEV(Y,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:574,columnNumber:61},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:551,columnNumber:53},this),t&&e.jsxDEV(b,{size:"icon",variant:"ghost",className:"absolute left-8 top-1 h-6 w-6 text-slate-400 opacity-0 transition-opacity hover:text-cyan-400 hover:bg-cyan-600/20 focus:text-cyan-400 focus:bg-cyan-600/20 group-hover:opacity-100",onClick:a=>{a.stopPropagation(),t(m.requestId)},title:"ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ð¸Ñ‚ÑŒ Ð·Ð°Ð¿Ñ€Ð¾Ñ",children:e.jsxDEV(K,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:592,columnNumber:57},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:580,columnNumber:53},this),e.jsxDEV(b,{size:"icon",variant:"ghost",className:"absolute right-7 top-1 h-6 w-6 text-slate-400 opacity-0 transition-opacity hover:text-yellow-400 hover:bg-yellow-600/20 group-hover:opacity-100",onClick:a=>{a.stopPropagation(),H(m.id)},title:"Ð—Ð°ÐºÑ€ÐµÐ¿Ð¸Ñ‚ÑŒ",children:e.jsxDEV(ne,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:606,columnNumber:53},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:596,columnNumber:49},this),e.jsxDEV(b,{size:"icon",variant:"ghost",className:"absolute right-1 top-1 h-6 w-6 text-slate-400 opacity-0 transition-opacity hover:text-red-400 hover:bg-red-600/20 group-hover:opacity-100",onClick:a=>q(a,m.id),disabled:d,title:"Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ñ„Ð°Ð¹Ð»",children:e.jsxDEV(W,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:622,columnNumber:53},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:609,columnNumber:49},this)]},m.id,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:520,columnNumber:45},this))},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:518,columnNumber:37},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:497,columnNumber:29},this),B.length>0&&e.jsxDEV("div",{children:[e.jsxDEV("button",{onClick:()=>f(!S),className:"flex w-full items-center justify-between rounded-lg bg-slate-700/0 px-3 py-2 text-sm font-medium text-slate-200 hover:bg-slate-700 transition-colors",children:[e.jsxDEV("div",{className:"flex gap-2 items-center",children:[e.jsxDEV(X,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:641,columnNumber:41},this),e.jsxDEV("span",{children:["Ð’Ð¸Ð´ÐµÐ¾ (",B.length,")"]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:642,columnNumber:41},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:640,columnNumber:37},this),e.jsxDEV(re,{className:`h-4 w-4 transition-transform ${S?"rotate-180":""}`},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:645,columnNumber:37},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:634,columnNumber:33},this),S&&e.jsxDEV("div",{className:"grid grid-cols-3 gap-2 mt-2",children:Ee.map(m=>e.jsxDEV("div",{className:"group relative cursor-pointer transition-transform hover:scale-105",onClick:a=>{a.stopPropagation(),O(m)},role:"button",tabIndex:0,onKeyDown:a=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),O(m))},children:[e.jsxDEV("div",{onClick:a=>a.stopPropagation(),children:e.jsxDEV(le,{file:m,className:"h-full w-full"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:678,columnNumber:53},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:673,columnNumber:49},this),r&&e.jsxDEV(b,{size:"icon",variant:"ghost",className:"absolute left-1 top-1 h-6 w-6 text-slate-400 opacity-0 transition-opacity hover:text-cyan-400 hover:bg-cyan-600/20 group-hover:opacity-100",onClick:a=>{if(a.stopPropagation(),!m.path)return;const N=M(m.path);r(N,m.filename)},title:"ÐŸÑ€Ð¸ÐºÑ€ÐµÐ¿Ð¸Ñ‚ÑŒ Ðº Ð¿Ñ€Ð¾Ð¼Ð¿Ñ‚Ñƒ",children:e.jsxDEV(Y,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:704,columnNumber:57},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:685,columnNumber:53},this),e.jsxDEV(b,{size:"icon",variant:"ghost",className:"absolute left-1 top-8 h-6 w-6 text-slate-400 opacity-0 transition-opacity hover:text-blue-400 hover:bg-blue-600/20 group-hover:opacity-100",onClick:a=>{a.stopPropagation(),O(m)},title:"Ð Ð°Ð·Ð²ÐµÑ€Ð½ÑƒÑ‚ÑŒ Ð²Ð¸Ð´ÐµÐ¾",children:e.jsxDEV(De,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:718,columnNumber:53},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:708,columnNumber:49},this),t&&e.jsxDEV(b,{size:"icon",variant:"ghost",className:"absolute left-8 top-1 h-6 w-6 text-slate-400 opacity-0 transition-opacity hover:text-cyan-400 hover:bg-cyan-600/20 focus:text-cyan-400 focus:bg-cyan-600/20 group-hover:opacity-100",onClick:a=>{a.stopPropagation(),t(m.requestId)},title:"ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ð¸Ñ‚ÑŒ Ð·Ð°Ð¿Ñ€Ð¾Ñ",children:e.jsxDEV(K,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:734,columnNumber:57},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:722,columnNumber:53},this),e.jsxDEV(b,{size:"icon",variant:"ghost",className:"absolute right-1 top-1 h-6 w-6 text-slate-400 opacity-0 transition-opacity hover:text-red-400 hover:bg-red-600/20 group-hover:opacity-100",onClick:a=>q(a,m.id),disabled:d,title:"Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ñ„Ð°Ð¹Ð»",children:e.jsxDEV(W,{className:"h-3.5 w-3.5"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:751,columnNumber:53},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:738,columnNumber:49},this)]},m.id,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:654,columnNumber:45},this))},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:652,columnNumber:37},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:633,columnNumber:29},this),D?.pagination&&D.pagination.page<D.pagination.totalPages&&e.jsxDEV("div",{ref:x,className:"flex h-20 items-center justify-center",children:F?e.jsxDEV("div",{className:"text-xs text-slate-400",children:"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ°..."},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:769,columnNumber:41},this):e.jsxDEV("div",{className:"h-1 w-1 rounded-full bg-slate-600"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:773,columnNumber:41},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:764,columnNumber:33},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:359,columnNumber:21},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:358,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:339,columnNumber:13},this),l&&e.jsxDEV(e.Fragment,{children:[l.type==="VIDEO"&&l.path&&e.jsxDEV(we,{open:!!l,onOpenChange:m=>!m&&h(null),children:e.jsxDEV(xe,{showCloseButton:!1,className:"max-h-[95vh] max-w-[95vw] overflow-hidden border-border bg-background p-0",children:[e.jsxDEV(ve,{className:"sr-only",children:["ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ Ð²Ð¸Ð´ÐµÐ¾: ",l.filename]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:796,columnNumber:33},this),e.jsxDEV("div",{className:"relative",children:[e.jsxDEV("video",{src:M(l.path),controls:!0,autoPlay:!0,className:"max-h-[90vh] w-full"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:800,columnNumber:37},this),e.jsxDEV("div",{className:"absolute right-2 top-2 flex gap-2",children:[t&&e.jsxDEV(b,{size:"icon",variant:"secondary",onClick:m=>{m.stopPropagation(),t(l.requestId)},className:"h-9 w-9 text-slate-400 hover:text-cyan-400 focus:text-cyan-400",title:"ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ð¸Ñ‚ÑŒ Ð·Ð°Ð¿Ñ€Ð¾Ñ",children:e.jsxDEV(K,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:820,columnNumber:49},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:808,columnNumber:45},this),e.jsxDEV(b,{size:"icon",variant:"secondary",onClick:()=>{l.path&&de(M(l.path),l.filename)},title:"Ð¡ÐºÐ°Ñ‡Ð°Ñ‚ÑŒ Ñ„Ð°Ð¹Ð»",children:e.jsxDEV(se,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:837,columnNumber:45},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:823,columnNumber:41},this),e.jsxDEV(b,{size:"icon",variant:"secondary",onClick:()=>h(null),children:e.jsxDEV(ce,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:846,columnNumber:45},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:839,columnNumber:41},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:806,columnNumber:37},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:799,columnNumber:33},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:792,columnNumber:29},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:786,columnNumber:25},this),l.type!=="VIDEO"&&e.jsxDEV(xs,{file:l,onClose:()=>h(null),onAttachFile:r,onRepeatRequest:t,isPinned:C.has(l.id),onTogglePin:()=>H(l.id)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:855,columnNumber:25},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:783,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/components/media/media-gallery.tsx",lineNumber:338,columnNumber:9},this)}function Us(){const{chatId:s}=_e.useParams(),r=parseInt(s),{data:t,isLoading:l,isFetching:h,error:w,refetch:d}=Ue({id:r,limit:10},{refetchOnMountOrArgChange:!0,skip:!1});o.useEffect(()=>{console.log("[Chat] Ð¡Ð¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸:",{chatId:r,isChatLoading:l,isChatFetching:h,hasChat:!!t,requestsCount:t?.requests?.length||0,error:w})},[r,l,h,t,w]);const[u]=Oe(),[p]=Re(),[I]=$e(),{isTestMode:v}=Ke(),[x,S]=o.useState("NANO_BANANA_PRO_KIEAI"),[f,T]=o.useState(null),[g,U]=o.useState(null),E=o.useRef(null),J=o.useRef(!0),A=o.useRef(r);o.useEffect(()=>{A.current!==r&&(console.log("[Chat] Ð¡Ð¼ÐµÐ½Ð° Ñ‡Ð°Ñ‚Ð°:",{previous:A.current,current:r}),J.current=!0,A.current=r,T(null),U(null),d())},[r,d]),o.useEffect(()=>{const i=()=>{console.log("[Chat] ðŸ”„ ÐžÐºÐ½Ð¾ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ð»Ð¾ Ñ„Ð¾ÐºÑƒÑ, Ð¾Ð±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ñ‡Ð°Ñ‚Ð°"),d().catch(c=>{console.error("[Chat] ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ð¸ Ñ‡Ð°Ñ‚Ð° Ð¿Ð¾ÑÐ»Ðµ Ñ„Ð¾ÐºÑƒÑÐ°:",c)})};return window.addEventListener("focus",i),()=>{window.removeEventListener("focus",i)}},[d]),o.useEffect(()=>{const i=t;if(i&&J.current){S(i.model),J.current=!1;return}},[t]);async function C(i){if(i===x)return;const c=x;S(i);const j=t;if(j)try{await u({id:j.id,model:i}).unwrap()}catch(V){S(c);const te=V&&typeof V=="object"&&"data"in V&&V.data&&typeof V.data=="object"&&"error"in V.data&&typeof V.data.error=="string"?V.data.error:"ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð¾Ð±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ð¼Ð¾Ð´ÐµÐ»ÑŒ. ÐŸÐ¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ ÐµÑ‰Ðµ Ñ€Ð°Ð·.";alert(`ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ð¼Ð¾Ð´ÐµÐ»Ð¸: ${te}`),console.error("[Chat] ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ Ð¼Ð¾Ð´ÐµÐ»Ð¸:",V)}}const P=!f||v,{data:n}=ze(f,{skip:P,pollingInterval:v?0:3e3,refetchOnMountOrArgChange:!0});function k(i){const c={id:`pending-${Date.now()}`,prompt:i,model:x,createdAt:new Date().toISOString(),status:"PENDING"};U(c),console.log("[Chat] â³ Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¾ pending-ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ:",c.id)}function D(i){U(c=>c?(console.log("[Chat] âŒ Pending-ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð¿Ð¾Ð¼ÐµÑ‡ÐµÐ½Ð¾ ÐºÐ°Ðº FAILED"),{...c,status:"FAILED",errorMessage:i}):null)}function Q(i){if(console.log("[Chat] âœ… ÐÐ¾Ð²Ñ‹Ð¹ Ð·Ð°Ð¿Ñ€Ð¾Ñ ÑÐ¾Ð·Ð´Ð°Ð½, Ð¾Ð±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ Ñ‡Ð°Ñ‚ Ð¸ Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ polling:",{requestId:i}),U(c=>c?{...c,requestId:i}:null),d().catch(c=>{console.error("[Chat] ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ð¸ Ñ‡Ð°Ñ‚Ð°:",c)}),v){console.log("[Chat] ðŸ§ª Ð¢ÐµÑÑ‚Ð¾Ð²Ñ‹Ð¹ Ñ€ÐµÐ¶Ð¸Ð¼: polling Ð¾Ñ‚ÐºÐ»ÑŽÑ‡ÐµÐ½ Ð´Ð»Ñ Ð½Ð¾Ð²Ð¾Ð³Ð¾ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ°");return}T(i)}o.useEffect(()=>{v&&f!==null&&(console.log("[Chat] ðŸ§ª Ð¢ÐµÑÑ‚Ð¾Ð²Ñ‹Ð¹ Ñ€ÐµÐ¶Ð¸Ð¼ Ð²ÐºÐ»ÑŽÑ‡ÐµÐ½: Ð¾ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ polling"),T(null))},[v,f]);const F=o.useRef(null),L=o.useRef(null),_=o.useRef(null),G=300*1e3;o.useEffect(()=>{f&&!_.current&&(_.current=Date.now())},[f]),o.useEffect(()=>{if(n){if(n.id!==f){console.log("[Chat] âš ï¸ pollingRequest.id Ð½Ðµ ÑÐ¾Ð²Ð¿Ð°Ð´Ð°ÐµÑ‚ Ñ pollingRequestId, Ð¸Ð³Ð½Ð¾Ñ€Ð¸Ñ€ÑƒÐµÐ¼:",{pollingRequestId:n.id,expectedId:f});return}const i=n.status,c=F.current,j=n.files?.length||0,V=L.current;if(_.current&&Date.now()-_.current>G){console.warn("[Chat] âš ï¸ Polling Ð¿Ñ€ÐµÐ²Ñ‹ÑÐ¸Ð» Ð¼Ð°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ, Ð¾ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼"),T(null),_.current=null,F.current=null,L.current=null,d();return}const te=c!==i,ke=V!==null&&V!==j,ye=c===null;console.log("[Chat] Polling request ÑÑ‚Ð°Ñ‚ÑƒÑ:",{id:n.id,status:i,previousStatus:c,statusChanged:te,filesCount:j,previousFilesCount:V,filesCountChanged:ke,isFirstRequest:ye,errorMessage:n.errorMessage||null}),U(y=>{if(!y||!f||y.requestId!==f)return y;const Ae=i==="PROCESSING",Se=i==="FAILED",Te=Ae?"PROCESSING":Se?"FAILED":y.status,je=Se&&(n.errorMessage||!0)?n.errorMessage||"Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ Ð½Ðµ ÑƒÐ´Ð°Ð»Ð°ÑÑŒ. Ð”ÐµÑ‚Ð°Ð»Ð¸ Ð¾ÑˆÐ¸Ð±ÐºÐ¸ Ð½Ðµ Ð¿Ñ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ñ‹ Ð¿Ñ€Ð¾Ð²Ð°Ð¹Ð´ÐµÑ€Ð¾Ð¼.":y.errorMessage;return Te===y.status&&je===y.errorMessage?y:{...y,status:Te,errorMessage:je}}),(ye||te||ke||i==="PROCESSING"&&c==="PROCESSING"&&Date.now()%3e3<1500)&&(console.log("[Chat] ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ Ñ‡Ð°Ñ‚"),d().catch(y=>{console.error("[Chat] ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ð¸ Ñ‡Ð°Ñ‚Ð°:",y)})),i==="COMPLETED"||i==="FAILED"?(console.log("[Chat] Ð—Ð°Ð¿Ñ€Ð¾Ñ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½, Ð¾ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ polling"),T(null),_.current=null,F.current=null,L.current=null,setTimeout(()=>{d().catch(y=>{console.error("[Chat] ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ñ„Ð¸Ð½Ð°Ð»ÑŒÐ½Ð¾Ð¼ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ð¸ Ñ‡Ð°Ñ‚Ð°:",y)})},500),setTimeout(()=>{d().catch(y=>{console.error("[Chat] ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð¼ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ð¸ Ñ‡Ð°Ñ‚Ð°:",y)})},1500)):(F.current=i,L.current=j)}},[n,f,d,G]);const H=o.useMemo(()=>t?.requests||[],[t?.requests]);if(o.useEffect(()=>{if(!g?.requestId)return;const i=H.some(j=>j.id===g.requestId);n&&n.id===g.requestId&&(n.status==="COMPLETED"||n.status),i&&(console.log("[Chat] ðŸ”„ Ð—Ð°Ð¿Ñ€Ð¾Ñ Ð½Ð°Ð¹Ð´ÐµÐ½, ÑƒÐ±Ð¸Ñ€Ð°ÐµÐ¼ pending-ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ"),U(null))},[H,g,n]),l&&!t)return e.jsxDEV("div",{className:"flex h-screen bg-background",children:[e.jsxDEV(oe,{},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/routes/media/$chatId.tsx?tsr-split=component",lineNumber:378,columnNumber:17},this),e.jsxDEV("div",{className:"flex flex-1 items-center justify-center",children:e.jsxDEV($,{className:"h-8 w-8 animate-spin text-primary"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/routes/media/$chatId.tsx?tsr-split=component",lineNumber:380,columnNumber:21},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/routes/media/$chatId.tsx?tsr-split=component",lineNumber:379,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/routes/media/$chatId.tsx?tsr-split=component",lineNumber:377,columnNumber:12},this);if(w&&!t)return e.jsxDEV("div",{className:"flex h-screen bg-background",children:[e.jsxDEV(oe,{},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/routes/media/$chatId.tsx?tsr-split=component",lineNumber:388,columnNumber:17},this),e.jsxDEV("div",{className:"flex flex-1 flex-col items-center justify-center text-center",children:[e.jsxDEV("p",{className:"text-xl text-destructive",children:"ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ñ‡Ð°Ñ‚Ð°"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/routes/media/$chatId.tsx?tsr-split=component",lineNumber:390,columnNumber:21},this),e.jsxDEV("p",{className:"text-sm text-muted-foreground mt-2",children:"ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ñ‡Ð°Ñ‚. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸Ðµ Ñ ÑÐµÑ€Ð²ÐµÑ€Ð¾Ð¼."},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/routes/media/$chatId.tsx?tsr-split=component",lineNumber:391,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/routes/media/$chatId.tsx?tsr-split=component",lineNumber:389,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/routes/media/$chatId.tsx?tsr-split=component",lineNumber:387,columnNumber:12},this);if(!t&&!l&&!w)return e.jsxDEV("div",{className:"flex h-screen bg-background",children:[e.jsxDEV(oe,{},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/routes/media/$chatId.tsx?tsr-split=component",lineNumber:402,columnNumber:17},this),e.jsxDEV("div",{className:"flex flex-1 flex-col items-center justify-center text-center",children:[e.jsxDEV("p",{className:"text-xl text-muted-foreground",children:"Ð§Ð°Ñ‚ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/routes/media/$chatId.tsx?tsr-split=component",lineNumber:404,columnNumber:21},this),e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ‡Ð°Ñ‚ Ð¸Ð· ÑÐ¿Ð¸ÑÐºÐ° Ð¸Ð»Ð¸ ÑÐ¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ð½Ð¾Ð²Ñ‹Ð¹"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/routes/media/$chatId.tsx?tsr-split=component",lineNumber:405,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/routes/media/$chatId.tsx?tsr-split=component",lineNumber:403,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/routes/media/$chatId.tsx?tsr-split=component",lineNumber:401,columnNumber:12},this);if(!t)return null;const B=t,R=[...B.requests||[]].sort((i,c)=>new Date(i.createdAt).getTime()-new Date(c.createdAt).getTime()).map(i=>n&&f&&i.id===n.id&&i.id===f?n:i),ie=g&&!R.some(i=>g.requestId?i.id===g.requestId:!1)&&g?{id:-1,chatId:r,prompt:g.prompt,model:g.model,status:g.status,inputFiles:[],errorMessage:g.errorMessage||null,createdAt:g.createdAt,completedAt:null,seed:null,files:[]}:null,ue=ie?[...R,ie]:R;function O(i){E.current?.setPrompt(i)}async function q(i,c){await E.current?.addFileFromUrl(i,c)}async function m(i,c){const j=c||i.model;if(j&&j!==x&&C(j),E.current){await E.current.setRequestData(i);const V=document.getElementById("chat-input");V&&V.scrollIntoView({behavior:"smooth"})}}async function a(i){try{const c=await I(i).unwrap();c&&await m(c)}catch(c){console.error("[Chat] ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð·Ð°Ð¿Ñ€Ð¾ÑÐ°:",c),alert("ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ° Ð´Ð»Ñ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€ÐµÐ½Ð¸Ñ")}}const N=h&&!l;return e.jsxDEV("div",{className:"flex h-screen bg-background",children:[e.jsxDEV(oe,{},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/routes/media/$chatId.tsx?tsr-split=component",lineNumber:517,columnNumber:13},this),e.jsxDEV("div",{className:"flex flex-1 flex-col",children:[e.jsxDEV(ys,{name:B.name,model:x,showUpdating:N},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/routes/media/$chatId.tsx?tsr-split=component",lineNumber:522,columnNumber:17},this),e.jsxDEV(ws,{requests:ue,chatModel:x,onEditPrompt:O,onAttachFile:q,onRepeatRequest:m},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/routes/media/$chatId.tsx?tsr-split=component",lineNumber:525,columnNumber:17},this),e.jsxDEV(We,{ref:E,chatId:r,currentModel:x,onModelChange:C,onRequestCreated:Q,onPendingMessage:k,onSendError:D},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/routes/media/$chatId.tsx?tsr-split=component",lineNumber:528,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/routes/media/$chatId.tsx?tsr-split=component",lineNumber:520,columnNumber:13},this),e.jsxDEV(ks,{chatId:r,onAttachFile:q,onRepeatRequest:a},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/routes/media/$chatId.tsx?tsr-split=component",lineNumber:532,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/routes/media/$chatId.tsx?tsr-split=component",lineNumber:515,columnNumber:10},this)}function ys({name:s,model:r,showUpdating:t}){const{data:l}=Ve(),h=l?.find(w=>w.key===r);return e.jsxDEV("div",{className:ae(me,"bg-background"),children:e.jsxDEV("div",{className:"flex items-center gap-3",children:[e.jsxDEV("span",{className:"text-2xl",children:Qe(r)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/routes/media/$chatId.tsx?tsr-split=component",lineNumber:551,columnNumber:17},this),e.jsxDEV("div",{className:"flex-1",children:[e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV("h1",{className:"font-semibold text-foreground",children:s},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/routes/media/$chatId.tsx?tsr-split=component",lineNumber:554,columnNumber:25},this),t&&e.jsxDEV($,{className:"h-4 w-4 animate-spin text-muted-foreground"},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/routes/media/$chatId.tsx?tsr-split=component",lineNumber:555,columnNumber:42},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/routes/media/$chatId.tsx?tsr-split=component",lineNumber:553,columnNumber:21},this),e.jsxDEV("p",{className:"text-xs text-muted-foreground",children:h?.name||r},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/routes/media/$chatId.tsx?tsr-split=component",lineNumber:557,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/routes/media/$chatId.tsx?tsr-split=component",lineNumber:552,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/routes/media/$chatId.tsx?tsr-split=component",lineNumber:550,columnNumber:13},this)},void 0,!1,{fileName:"/Users/wowbae/Desktop/IT/JS/ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹/ai-media-api/src/routes/media/$chatId.tsx?tsr-split=component",lineNumber:549,columnNumber:10},this)}export{Us as component};
